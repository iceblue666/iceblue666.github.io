\-\-\-
title:开发博客的问题和解决方案
time:2021-03-08 14:49:00
categories:前端,博客
tags:前端,博客,问题
summary:开发本博客遇到的一些耗时长的问题和解决的方案
\-\-\-

# 开发博客的问题和解决方案

## 1. 怎么解决文件查找

用require.context遍历整个文件夹

```
const filesMD = require.context('/public/reso', true, /\.md$/);
const filesMDNames = filesMD.keys(); //fileMDNames就是路径
```

## 2. 怎么解决md文件读入

用mock，和axios，发现axios不仅可以读网络资源，也可以读文件

方便可扩展，如果后面接着写后端，直接不用改前端

public默认会打包所有进去，但是浏览器source显示

## 3. 怎么解决md文件的解析

用vue-markdown组件

github-markdown-css作为样式

highlight.js代码高亮

## 4. mock

mock本身是通过匹配路径来拦截返回相应的数据

但当有前缀相同的匹配规则时会有问题，比如

两个mock规则 `mock('/^article')`和`mock('/^articleDetail')`

就会发现articleDetail请求数据错误，返回的都是article的数据

## 5. 自制文件系统

```javascript
// tempListDatas是一群路径
ExtractFileSystem(tmepListDatas)
const fileSystem = createNode('reso',true,[],{});

function createNode(name, isFolder, children = [], info = {}){
  let newNode = {};
  newNode.name = name;
  newNode.isFolder = isFolder;
  newNode.children = children;
  newNode.info = info;
  return newNode;
}

// arr是当前还没有安进去的路径数组，node是对象点，info是要填的节点信息
function buildFileSystemTree(arr, node, info){
  if(arr.length === 1) {
    let newnode = createNode(arr[0].replace('.md', ''), false, [], info);
    node.children.push(newnode);
    return;
  }
  else {
    let nextnode = null;
    for(let it of node.children){
      if(it.name === arr[0]){
        nextnode = it;break;
      }
    }
    if(nextnode){
      arr.shift()
      buildFileSystemTree([...arr], nextnode, info);
    }
    else {
      nextnode = createNode(arr[0], true, [], {});
      arr.shift();
      node.children.push(nextnode);
      buildFileSystemTree([...arr], nextnode, info);
    }
  }
}

```
## 6.怎么限制摘要的行数
```
  display: -webkit-box;
  text-overflow: ellipsis;
  -webkit-box-orient: vertical;
  -webkit-line-clamp: 6;
  word-break: break-all;
  overflow: hidden;
```

## 7. gitPage无法更新

在确定一篇博客的模板格式后，发现gitPage构建报错了。

看了这篇文章后https://www.jianshu.com/p/938ec18e572a，觉得应该和我的问题差不多，可能是jekyll不支持---这种形式的md，所以会报错，暂行办法就是把-加转义\，长久之计是自己买服务器就没有这个检查了。

## 8. windows写bat方便git push

```
// deploy.bat
cd iceblue666.github.io
git add .
git commit -m '博客更新'
git push origin master
```

要注意是ANSI而不是utf8，否则会中文乱码